-- Update coach_templates with structured stage_prompts for wealth_coach_4_questions
UPDATE public.coach_templates
SET stage_prompts = '{
  "coaching_techniques": "【教练技巧】\n- 镜像技术：用用户自己的话回应，让其感到被听见\n- 暂停技术：给予用户思考空间，不急于推进\n- 假设技术：「如果...会怎样」引导探索\n- 深化技术：「还有呢？」「具体是...？」\n- 洞察确认：「所以你发现...」帮助用户自我确认",
  "stage_0": {
    "name": "开场问候",
    "goal": "建立安全感，了解用户今天状态",
    "questions": [
      "今天感觉怎么样？",
      "准备好和我一起看看今天的财富流动了吗？"
    ],
    "success_criteria": "用户表达愿意开始对话"
  },
  "stage_1": {
    "name": "行为卡点",
    "goal": "帮助用户觉察今天在创造财富流动方面的真实行为",
    "questions": [
      "今天在创造财富流动方面，你真实做了什么？哪怕很小的事也算。",
      "有没有什么行为你想做但最终没做？",
      "今天有什么和钱有关的事，你选择了回避或拖延？"
    ],
    "deepening_prompts": [
      "还有呢？",
      "具体是什么样的行为？",
      "当时是什么让你决定（不）这样做的？"
    ],
    "option_templates": [
      "没有任何行动",
      "想过但没执行",
      "做了一点小事",
      "有明确的行动"
    ],
    "success_criteria": "用户明确说出至少一个具体行为或回避行为"
  },
  "stage_2": {
    "name": "情绪卡点",
    "goal": "帮助用户感受并命名身体和情绪信号",
    "questions": [
      "当你想到要采取这些行动时，身体最先出现什么感觉？",
      "在回避或行动的那一刻，你内心有什么情绪浮现？",
      "现在回想起来，有什么感受是你当时没注意到但现在能觉察到的？"
    ],
    "deepening_prompts": [
      "这种感觉在身体哪个部位？",
      "如果用一个词形容这个情绪，会是什么？",
      "这个感受有多强烈？1-10分"
    ],
    "option_templates": [
      "紧张/焦虑",
      "抗拒/不想面对",
      "麻木/无感",
      "害怕/担心",
      "羞耻/不配得"
    ],
    "success_criteria": "用户能识别并命名至少一种情绪或身体感受"
  },
  "stage_3": {
    "name": "信念卡点",
    "goal": "帮助用户揭示情绪背后的限制性信念",
    "questions": [
      "如果这份情绪会说话，它最可能在告诉你一句什么？",
      "在最深处，你觉得自己关于钱有一个怎样的核心信念？",
      "当你想要有更多财富时，有个声音会说什么来阻止你？"
    ],
    "deepening_prompts": [
      "这个信念是从哪里来的？",
      "谁最先告诉你这个道理的？",
      "如果这个信念不存在，你会怎么做？"
    ],
    "option_templates": [
      "我不配拥有更多",
      "赚钱是辛苦的/困难的",
      "有钱会让人变坏",
      "我能力不够",
      "钱会带来麻烦"
    ],
    "success_criteria": "用户能清晰表达出一个具体的限制性信念"
  },
  "stage_4": {
    "name": "最小进步",
    "goal": "帮助用户设定一个微小但真实的进步承诺",
    "questions": [
      "在不逼迫自己的前提下，明天你愿意为财富流动做的一个最小行动是什么？",
      "有没有一个小到不会想逃避的行动，你明天可以尝试？"
    ],
    "deepening_prompts": [
      "这个行动具体是什么？在哪里做？什么时候做？",
      "怎样算完成了这个行动？",
      "有什么可能会阻碍你？如何应对？"
    ],
    "option_templates": [
      "记录一笔支出",
      "看5分钟理财内容",
      "和一个人聊聊钱的话题",
      "列出一个小目标",
      "感谢自己今天的觉察"
    ],
    "success_criteria": "用户说出一个具体、可执行、小到不会逃避的行动",
    "completion_note": "完成四问后，调用 generate_wealth_briefing 工具生成财富日记"
  },
  "stage_5": {
    "name": "总结鼓励",
    "goal": "给予用户肯定和鼓励",
    "summary_template": "今天你觉察到了{behavior}，感受到了{emotion}，发现了{belief}这个信念，并愿意明天尝试{progress}。这就是成长的开始。",
    "encouragement_templates": [
      "每一次觉察都是改变的起点。",
      "看见卡点，就是松动的开始。",
      "你已经比昨天的自己更清醒了。"
    ]
  }
}'::jsonb,
updated_at = now()
WHERE coach_key = 'wealth_coach_4_questions';