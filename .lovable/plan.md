

# å¯ç”¨è±†åŒ…è¯­éŸ³æ–¹æ¡ˆ

## å½“å‰çŠ¶æ€åˆ†æž

åœ¨ `src/components/coach/CoachVoiceChat.tsx` ç¬¬ 927 è¡Œï¼Œè±†åŒ…è¯­éŸ³å¼€å…³è¢«ç¡¬ç¼–ç ç¦ç”¨ï¼š

```typescript
// ðŸŽ¯ è±†åŒ…è¯­éŸ³ï¼šæš‚æ—¶ç¦ç”¨ï¼Œä½¿ç”¨ OpenAI Realtime
const useDoubaoVoice = false; // mode === 'emotion';  // ä¸´æ—¶ç¦ç”¨è±†åŒ…ï¼Œæ”¹ç”¨ OpenAI
```

## ä¿®æ”¹æ–¹æ¡ˆ

å°†è±†åŒ…è¯­éŸ³é‡æ–°å¯ç”¨ï¼Œæ¢å¤ä¸º `emotion` æ¨¡å¼ä½¿ç”¨è±†åŒ…çš„é€»è¾‘ï¼š

```typescript
// ðŸŽ¯ è±†åŒ…è¯­éŸ³ï¼šæƒ…ç»ªæ•™ç»ƒä½¿ç”¨è±†åŒ… Realtimeï¼ˆé™è€å¸ˆï¼‰
const useDoubaoVoice = mode === 'emotion';
```

## å¯ç”¨åŽçš„æ•ˆæžœ

| æ•™ç»ƒç±»åž‹ | mode å€¼ | è¯­éŸ³æœåŠ¡ |
|---------|---------|---------|
| æƒ…ç»ªæ•™ç»ƒ | `emotion` | **è±†åŒ…è¯­éŸ³**ï¼ˆé™è€å¸ˆäººè®¾ï¼‰ |
| æœ‰åŠ²ç”Ÿæ´»æ•™ç»ƒ | `general` | OpenAI Realtime |
| äº²å­æ•™ç»ƒ | `parent_teen` | OpenAI Realtime |
| é’å°‘å¹´æ•™ç»ƒ | `teen` | OpenAI Realtime |

## æŠ€æœ¯ç»†èŠ‚

### è±†åŒ…è¯­éŸ³æž¶æž„

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       JSON/WS       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      Binary      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æµè§ˆå™¨    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚ doubao-realtime-relay â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚  è±†åŒ… API   â”‚
â”‚  å®¢æˆ·ç«¯    â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚    (Edge Function)    â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ å­—èŠ‚è·³åŠ¨    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç›¸å…³é…ç½®

- **Token Endpoint**: `doubao-realtime-token`
- **Relay Function**: `doubao-realtime-relay`  
- **éŸ³é¢‘æ ¼å¼**: PCM16 (è¾“å…¥ 16kHz / è¾“å‡º 24kHz)
- **è§’è‰²**: é™è€å¸ˆ - æ¸©æš–çš„æƒ…ç»ªé™ªä¼´æ•™ç»ƒ
- **Secrets**: `DOUBAO_APP_ID`, `DOUBAO_ACCESS_TOKEN` (å·²é…ç½®)

### é™çº§ç­–ç•¥

è±†åŒ…è¿žæŽ¥å¤±è´¥æ—¶ä¼šè‡ªåŠ¨é™çº§åˆ° OpenAI WebRTCï¼š
1. æ£€æµ‹è®¤è¯é”™è¯¯ â†’ é‡å®šå‘ç™»å½•
2. å…¶ä»–è¿žæŽ¥é”™è¯¯ â†’ åˆ‡æ¢åˆ° OpenAI å¤‡ç”¨é€šé“

## ä¿®æ”¹æ–‡ä»¶

**æ–‡ä»¶**: `src/components/coach/CoachVoiceChat.tsx`  
**ä½ç½®**: ç¬¬ 927 è¡Œ  
**æ”¹åŠ¨**: 1 è¡Œä»£ç 

